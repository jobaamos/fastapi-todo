<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Terawork Todo List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        transition: background-color 0.5s ease, color 0.5s ease;
      }

      .todo-card {
        transition: transform 0.3s ease, opacity 0.3s ease;
      }

      .todo-card:hover {
        transform: scale(1.02);
      }

      .fade-in {
        animation: fadeIn 0.6s ease-in-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Dark mode styling */
      .dark-mode {
        background-color: #0f172a;
        color: #f8fafc;
      }

      /* Toggle button */
      #theme-toggle {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background-color: #2563eb;
        color: white;
        padding: 10px 12px;
        border-radius: 9999px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease;
      }

      #theme-toggle:hover {
        transform: scale(1.1);
      }
    </style>
  </head>
  <body
    class="bg-gray-100 text-gray-900 flex flex-col items-center justify-center min-h-screen p-4"
  >
    <div class="w-full max-w-2xl">
      <h1 class="text-3xl font-bold text-center text-blue-600 mb-6">
        Terawork Todo List
      </h1>

      <div
        class="bg-white rounded-xl shadow-md p-6 mb-6 flex flex-col md:flex-row gap-4 fade-in"
      >
        <input
          type="text"
          id="title"
          placeholder="Title"
          class="flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
        <input
          type="text"
          id="description"
          placeholder="Description"
          class="flex-[2] border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
        <button
          onclick="addTodo()"
          class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
        >
          Add
        </button>
      </div>

      <div id="todo-list" class="space-y-4"></div>
    </div>

    <!-- Theme toggle button (icon only) -->
    <button id="theme-toggle" title="Toggle Theme">
      üåô
    </button>

    <script>
      const apiUrl = "https://todo-api-qn10.onrender.com/todos";
      const todoList = document.getElementById("todo-list");
      const themeToggle = document.getElementById("theme-toggle");

      async function fetchTodos() {
        const response = await fetch(apiUrl);
        const todos = await response.json();
        todoList.innerHTML = "";
        todos.forEach((todo) => displayTodo(todo));
      }

      function displayTodo(todo) {
        const card = document.createElement("div");
        card.className =
          "todo-card bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex flex-col fade-in";
        card.innerHTML = `
          <h3 class="text-lg font-semibold">${todo.title}</h3>
          <p class="text-gray-600 dark:text-gray-300">${todo.description}</p>
          <div class="flex justify-end gap-2 mt-3">
            <button onclick="toggleTodo(${todo.id}, ${todo.is_completed})" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 transition">
              ${todo.is_completed ? "Undo" : "Done"}
            </button>
            <button onclick="deleteTodo(${todo.id})" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition">
              Delete
            </button>
          </div>
        `;
        todoList.appendChild(card);
      }

      async function addTodo() {
        const title = document.getElementById("title").value.trim();
        const description = document.getElementById("description").value.trim();
        if (!title || !description) return alert("Please fill both fields!");

        const response = await fetch(apiUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ title, description }),
        });

        const newTodo = await response.json();
        displayTodo(newTodo.todo);
        document.getElementById("title").value = "";
        document.getElementById("description").value = "";
      }

      async function deleteTodo(id) {
        await fetch(`${apiUrl}/${id}`, { method: "DELETE" });
        fetchTodos();
      }

      async function toggleTodo(id, is_completed) {
        await fetch(`${apiUrl}/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ is_completed: !is_completed }),
        });
        fetchTodos();
      }

      // Theme toggle functionality
      themeToggle.addEventListener("click", () => {
        document.body.classList.toggle("dark-mode");
        const isDark = document.body.classList.contains("dark-mode");
        themeToggle.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });

      // Load theme from storage
      window.onload = () => {
        if (localStorage.getItem("theme") === "dark") {
          document.body.classList.add("dark-mode");
          themeToggle.textContent = "‚òÄÔ∏è";
        }
        fetchTodos();
      };
    </script>
  </body>
</html>


